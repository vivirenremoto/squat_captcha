<!DOCTYPE html>
<html>

<head>
    <title>Form with Squat Captcha</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>

    <style>
        label,
        input {
            display: block;
        }
    </style>

    <h1>Form with Squat Captcha</h1>

    <p>This demo works with chrome/firefox, desktop environment and also a webcam.</p>

    <p>Click the button to try this infamous captcha.</p>

    <form id="form">

        <p>
            <label>Your Email</label>
            <input name="email">
        </p>
        <p>
            <button type="submit">Unsubscribe</button>
        </p>

    </form>




    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script>
        var captcha_done = false;
        var captcha_url = 'https://vivirenremoto.github.io/squat_captcha/';

        function captcha_complete(e) {
            if (e.origin.indexOf('vivirenremoto.github.io') > -1) {
                captcha_done = true;
                jQuery('#squat_captcha').remove();
                alert('form sent');
            }
        }


        function showCaptcha() {
            if (captcha_done == false) {
                jQuery('body').append('<iframe allow="camera;microphone" id="squat_captcha" src="' + captcha_url + '" style="background:#fff;border:0;position:fixed;top:0;left:0;width:100%;height:100%;"></iframe>');
                window.addEventListener('message', captcha_complete, false);
            }
        }

        jQuery(function () {
            $('#form').submit(function () {
                if (!captcha_done) {
                    showCaptcha();
                    event.preventDefault();
                    return;
                }
            });
        });
    </script>


</body>

</html>